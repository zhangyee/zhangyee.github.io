
<!DOCTYPE html>
<html lang="zh-cn">
    
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Yee的慢生活志">
    <title>我为什么必须要破解电信光猫？ - Yee的慢生活志</title>
    <meta name="author" content="Yee Zhang">
    
    
        <link rel="alternative" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <meta name="description" content="搬了新房近一年，终于弄好了家里的网络部署，为什么拖拖拉拉搞了这么久？对于一个曾经从事过六年骨干网运维管理的工程师，个中原因真是一言难尽……
背景奇葩的开放商将屋内弱电箱的位置设计在客厅靠近中间的墙上（下图中红色五星位置），而我需要接入网络的信息点位置如下图，绿色笑脸为电视（LeTV）、各种盒子、Raspberry Pi、路由器、家庭NAS存储等需要以太网有线接入的位置；蓝色网络信号为家里需要无线W">
<meta property="og:type" content="blog">
<meta property="og:title" content="我为什么必须要破解电信光猫？">
<meta property="og:url" content="http://www.yeezhang.im/2015/12/10/0003-Why-I-must-crack-ChinaNet-GPON-Modem/index.html">
<meta property="og:site_name" content="Yee的慢生活志">
<meta property="og:description" content="搬了新房近一年，终于弄好了家里的网络部署，为什么拖拖拉拉搞了这么久？对于一个曾经从事过六年骨干网运维管理的工程师，个中原因真是一言难尽……
背景奇葩的开放商将屋内弱电箱的位置设计在客厅靠近中间的墙上（下图中红色五星位置），而我需要接入网络的信息点位置如下图，绿色笑脸为电视（LeTV）、各种盒子、Raspberry Pi、路由器、家庭NAS存储等需要以太网有线接入的位置；蓝色网络信号为家里需要无线W">
<meta property="og:image" content="http://www.yeezhang.im/home_networking_requirement.png">
<meta property="og:image" content="http://www.yeezhang.im/schneider_weak_box.jpg">
<meta property="og:image" content="http://www.yeezhang.im/netcore_switch.png">
<meta property="og:image" content="http://www.yeezhang.im/HG8120C_ChinaNet_Ver_Web.png">
<meta property="og:image" content="http://www.yeezhang.im/HG8120C_ttl_pin.png">
<meta property="og:image" content="http://www.yeezhang.im/HG8120C_ttl_breakout.png">
<meta property="og:image" content="http://www.yeezhang.im/HG8120C_su.png">
<meta property="og:image" content="http://www.yeezhang.im/ONT_enable_tool.png">
<meta property="og:image" content="http://www.yeezhang.im/su_verification.png">
<meta property="og:image" content="http://www.yeezhang.im/HG8120C_huawei_Ver_Web.png">
<meta property="og:image" content="http://www.yeezhang.im/HG8120C_huawei_Ver_feature.png">
<meta property="og:updated_time" content="2015-12-17T06:33:41.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="我为什么必须要破解电信光猫？">
<meta name="twitter:description" content="搬了新房近一年，终于弄好了家里的网络部署，为什么拖拖拉拉搞了这么久？对于一个曾经从事过六年骨干网运维管理的工程师，个中原因真是一言难尽……
背景奇葩的开放商将屋内弱电箱的位置设计在客厅靠近中间的墙上（下图中红色五星位置），而我需要接入网络的信息点位置如下图，绿色笑脸为电视（LeTV）、各种盒子、Raspberry Pi、路由器、家庭NAS存储等需要以太网有线接入的位置；蓝色网络信号为家里需要无线W">
    
    
    
        <meta property="og:image" content="/assets/images/gravatar.jpg"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style.min.css" type="text/css">
    <!--STYLES END-->
    
    
    <script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?c05b7b18c13b48cc1f2c5720d98dc307";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
    </script>


</head>

    <body>
        <div id="blog">
            <header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <h1 class="header-title">
        <a class="header-title-link" href="/ ">Yee的慢生活志</a>
    </h1>
    
        <a class="header-right-picture" href="/#about">
            <img class="header-picture" src="/assets/images/gravatar.jpg"/>
        </a>
    
</header>
            <nav id="sidebar" data-behavior="1">
    
        <div class="sidebar-profile">
            <a href="/#about">
                
                    <img class="sidebar-profile-picture" src="/assets/images/gravatar.jpg"/>
                
            </a>
            <span class="sidebar-profile-name">Yee Zhang</span>
        </div>
    
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/ "
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-home"></i>
                    <span class="sidebar-button-desc">首页</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-categories"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
                    <span class="sidebar-button-desc">分类</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-tags"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
                    <span class="sidebar-button-desc">标签</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-archives"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
                    <span class="sidebar-button-desc">归档</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/#about"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-question"></i>
                    <span class="sidebar-button-desc">关于我</span>
                </a>
        </li>
        
    </ul>
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="https://github.com/zhangyee" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-github"></i>
                    <span class="sidebar-button-desc">GitHub</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="http://stackoverflow.com/users/967500" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-stack-overflow"></i>
                    <span class="sidebar-button-desc">Stack Overflow</span>
                </a>
        </li>
        
    </ul>
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/atom.xml"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
                    <span class="sidebar-button-desc">RSS</span>
                </a>
        </li>
        
    </ul>
    
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post" itemscope itemType="http://schema.org/BlogPosting">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title" itemprop="headline">
            我为什么必须要破解电信光猫？
        </h1>
    
    <div class="post-meta">
    <time itemprop="datePublished" content="Thu Dec 10 2015 15:22:09 GMT+0800">
	
		    12月 10, 2015
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Networking/">Networking</a>


    
</div>
</div>
    
    <div class="post-content markdown" itemprop="articleBody">
        <div class="main-content-wrap">
            <p>搬了新房近一年，终于弄好了家里的网络部署，为什么拖拖拉拉搞了这么久？对于一个曾经从事过六年骨干网运维管理的工程师，个中原因真是一言难尽……</p>
<h1 id="u80CC_u666F"><a href="#u80CC_u666F" class="headerlink" title="背景"></a>背景</h1><p>奇葩的开放商将屋内弱电箱的位置设计在客厅靠近中间的墙上（下图中红色五星位置），而我需要接入网络的信息点位置如下图，绿色笑脸为电视（LeTV）、各种盒子、Raspberry Pi、路由器、家庭NAS存储等需要以太网有线接入的位置；蓝色网络信号为家里需要无线Wifi覆盖的地方，便于手机、iPad和电脑的随处使用。<br><div class="figure " style="width:;"><img class="fig-img" src="home_networking_requirement.png" width="" height="" alt=""></div><br>因为这个弱电箱预埋的接入线路为光纤入户，改变位置的施工容易弄断光纤；而屋外过道中的吊顶又完全封死，也没有办法在屋外重新熔接入户光纤另行布放。</p>
<h1 id="u7EA0_u7ED3_u4E4B_u5904"><a href="#u7EA0_u7ED3_u4E4B_u5904" class="headerlink" title="纠结之处"></a>纠结之处</h1><p>因此，这个弱电箱的位置是不能改变了。考虑到无线信号的稳定性（客厅到两间卧室的整面墙为石材装饰，信号穿透性很差），以及家里随处使用网络的方便性，我规划的家庭网络部署方案为：<br><blockquote><ul>
<li><strong>从弱电箱配线至每个房间的每个信息点；</strong></li>
<li><strong>用部署在弱电箱的路由器/电信光猫本身拨号，各房间的以太网端口可以DHCP自动获取内网IP、并NAT地址转换上网；</strong></li>
<li><strong>如果哪个房间需要Wifi，直接将配置为AP模式的无线路由器接入到对应的以太网端口即可（无线桥接），无线路由器无需做分配地址、拨号等其他设置。</strong></li>
</ul>
</blockquote><br>想要实现这个方案，问题也随之而来：</p>
<p>首先，为了弱电箱外观好看（谁叫它在客厅那个位置呐），我当时买的Schneider弱电箱内部空间偏小，即使放入中国电信最小的光猫——华为HG8120C，也仅能勉强再挤一台小尺寸的网络设备在里面。<br><div class="figure " style="width:;"><img class="fig-img" src="schneider_weak_box.jpg" width="" height="" alt=""></div><br>其次，直接配线至每个房间的每个信息点，需要在弱电箱内放置一台具备足够端口数（6~8端口）的网络设备。直接在光猫下挂一台有线路由器本来是最经济可行的方式，可惜小尺寸的路由器端口数都太少，如果不能把所有信息点都用有线接入进来，仅靠Wifi覆盖来解决，就失去了部署方案的稳定性与灵活性。家用交换机通常都有8个端口，尺寸迷你、价格便宜，如下图我最终选择的朗科Netcore NS108D，在京东购买才三十几元，差不多只有光猫的一半大小。<br><div class="figure " style="width:;"><img class="fig-img" src="netcore_switch.png" width="" height="" alt=""></div><br>如此一来，就要求交换机之上的电信光猫具备拨号、路由等能力。从规格来讲，华为HG8120C其实有蛮多功能的，可惜中国电信控制欲太强😂，ChinaNet“我的e家”宽带业务配套的光猫全为中国电信定制机，运行定制固件、没有超级用户及密码、关闭telnet命令行访问，用普通用户Web登录上去，除了能完成LOID注册外，仅能查询一些基本的业务参数，没有办法修改光猫缺省的桥接运行模式。多次联系电信的维护人员上门，他们也无法完成这些调整。</p>
<p>当然中国从来都是人多好办事的😄……通过在电信工作的老同学，安排工程师远程在网管系统上操作，拨号、路由统统搞掂，还短信我了超管帐号密码！本来也就没有后面的事情了，结果，使用一段时间才发现，内网中只能有4台终端（内网IP地址）可以正常访问互联网，其他终端能连入内网，但是无法访问外网！原来这也是中国电信的缺省限制，要修改，只能完全破解才行，即使有telecomadmin的超管帐号，也是没法修改这个参数的。<br><div class="figure " style="width:;"><img class="fig-img" src="HG8120C_ChinaNet_Ver_Web.png" width="" height="" alt=""></div><br><strong>我的折腾之旅从此开始！</strong></p>
<h1 id="u5931_u8D25_u7684_u7834_u89E3_u65B9_u6CD5"><a href="#u5931_u8D25_u7684_u7834_u89E3_u65B9_u6CD5" class="headerlink" title="失败的破解方法"></a>失败的破解方法</h1><p>虽然<a href="http://www.chinadsl.net" title="宽带技术网" target="_blank" rel="external">宽带技术网论坛</a>、百度文库、个人博客等地方有不少的文章都详细介绍了破解步骤与破解方法，但由于版本的问题，均已失效！华为和电信真是好基友，不断升级固件，在bugfix和新增功能的同时，用尽方法来限制用户不能随意更改设备配置。可是这设备是我买的啊，这宽带服务我也是缴费使用，凭什么限制我？我爱怎么用就该怎么用，入网用户协议上并未规定这些限制！气得我差点要投诉到工信部去！然并卵，还是尽快倒腾技术上的解决办法才行！</p>
<p>言归正传，说回破解！既然定制固件限制了telnet，那么是否可以从其他方式获取命令行的访问，这样是否网友们过去的破解方案就变得可行了呢？我们都知道，对于许多嵌入式产品，为了在生产时方便烧写firmware及出厂测试、售后维护，会在电路板上预留一个调试接口。万能的网友确实在HG8120C上发现了这个调试口，并分析出它就是一个TTL串口：<br><div class="figure " style="width:;"><img class="fig-img" src="HG8120C_ttl_pin.png" width="" height="" alt=""></div><br><blockquote><ul>
<li>1脚—是一根很细的导线，带一个电阻，一般是22R或33R，是信号线，一般是TX或RX</li>
<li>2脚—正面没见到连接，可能是空脚，而且90%以上是空脚，为啥待会解释</li>
<li>3脚—导线较粗，被挡住的部分看不清楚，但可以推断是电源VCC，可以上电量一下电压</li>
<li>4脚—GND，敷铜层采用十字连接，大面积敷铜连接，是GND没有错的</li>
<li>5脚—细导线，加一个电阻，信号线，同1脚，可能是TX或RX</li>
</ul>
</blockquote><br>以上是引用某位网友的分析（抱歉，原始链接我忘记了），经过我确认的ttl连接线序已在上图中注明。</p>
<div class="figure " style="width:;"><img class="fig-img" src="HG8120C_ttl_breakout.png" width="" height="" alt=""></div>
<p>有了这个串口的线序，稍微动动烙铁焊上插针，用一块现成的FTDI板子做<code>TTL-USB</code>转换，就可以在电脑上通过串口工具访问命令行了。串口的连接配置为：</p>
<blockquote>
<p>波特率：115200；数据位：8；奇偶校验：none；停止位：1</p>
</blockquote>
<div class="figure " style="width:;"><img class="fig-img" src="HG8120C_su.png" width="" height="" alt=""></div>
<p>为什么说它是一个失败的破解方式呢？因为这个被称为华为WAP的命令行环境登陆后，权限不足，支持的命令较少。新版固件如果想要<code>su</code>，会提示一个challenge码，要求输入这个challenge码换算的verfication码才可验证通过……华为真是挖空心思堵用户啊！</p>
<p>网上也有不少网友在尝试破解这个没有公开的challenge-verification code规则，更有人声称成功破解了规则并制作出算号软件。出于路由器破解灰色产业链的利益考虑，在网上无法找到算号软件，我也没有研究明白到底用的什么算法，破解路由器这件事情就只能放下来了，凑合着用！之所以把这个失败的破解方式专门写一写，一来是因为它很靠谱，从硬件入手，简单粗暴，只是受限于su权限，但从ttl串口进入的WAP环境和从IP telnet登录的运行环境是一致的；二来，获取su权限的challenge-verification code正是破解、修改路由器的关键，半年之后我终于从<code>活雷锋网友</code>处获得了这个算号软件，从而破解成功！</p>
<p>不过，考虑到大多数网友的硬件动手能力不强，我下面介绍的破解方式是通过纯软件的操作来实现的，不用动烙铁焊板子。</p>
<h1 id="u5982_u4F55_u6210_u529F_u7834_u89E3_u6700_u65B0_u56FA_u4EF6_u7684_u534E_u4E3AHG8120C_u5149_u732B"><a href="#u5982_u4F55_u6210_u529F_u7834_u89E3_u6700_u65B0_u56FA_u4EF6_u7684_u534E_u4E3AHG8120C_u5149_u732B" class="headerlink" title="如何成功破解最新固件的华为HG8120C光猫"></a>如何成功破解最新固件的华为HG8120C光猫</h1><p>好了，前面都是废话！对于可以看见这篇博客的人来说，最需要的是正确的破解姿势😄😄💪</p>
<h2 id="u4E00_u3001_u7834_u89E3_u65B9_u6CD5_u7B80_u8FF0"><a href="#u4E00_u3001_u7834_u89E3_u65B9_u6CD5_u7B80_u8FF0" class="headerlink" title="一、破解方法简述"></a>一、破解方法简述</h2><blockquote><ul>
<li>第一步：通过<code>华为ONT组播版本配置工具</code>使能光猫的telnet；</li>
<li>第二步：telnet登录光猫，运行<code>backup cfg</code>命令备份hw_ctree.xml配置文件（电脑需运行TFTP服务）；</li>
<li>第三步：通过<code>华为光猫配置文件加解密工具</code>解密hw_ctree.xml文件，获取telecomadmin超级管理员密码；</li>
<li>第四步：在telnet会话中su，通过<code>华为光猫SU密码计算器</code>计算验证码，获权后运行<code>restorehwmode.sh</code>脚本，直接将光猫恢复为华为官方版固件（非电信定制版）；</li>
<li>第五步：用缺省telecomadmin密码登录光猫的web管理界面，将原hw_ctree.xml备份文件（第二步备份的配置文件）再更新回光猫；</li>
<li>第六步：用第三步获得的telecomadmin帐号密码登录光猫，想怎么改配置就怎么改！！</li>
</ul>
</blockquote>
<p>在操作熟练的情况下，破解耗时不会超过10分钟！</p>
<h2 id="u4E8C_u3001_u9002_u7528_u7248_u672C"><a href="#u4E8C_u3001_u9002_u7528_u7248_u672C" class="headerlink" title="二、适用版本"></a>二、适用版本</h2><p>由于手上没有其他版本和型号的华为光猫，我这台2015年1月购买的HG8120C版本如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hardware version		= <span class="number">393</span>.E</span><br><span class="line">main software version 	= V3R013C10S118</span><br><span class="line">standby software version 	= V3R013C10S118</span><br><span class="line">uboot version 			= <span class="number">2010.03</span></span><br></pre></td></tr></table></figure><br>如您在其他版本和型号的华为光猫上成功破解，还望留言告知！</p>
<h2 id="u4E09_u3001_u7834_u89E3_u5DE5_u5177"><a href="#u4E09_u3001_u7834_u89E3_u5DE5_u5177" class="headerlink" title="三、破解工具"></a>三、破解工具</h2><p>需要使用的相关工具软件如下，皆为Windows版：<br><blockquote><ul>
<li>华为ONT组播版本配置工具</li>
<li>tftpd</li>
<li>华为光猫配置文件加解密工具</li>
<li>华为光猫SU密码计算器</li>
</ul>
</blockquote></p>
<p>下载地址：<a href="http://pan.baidu.com/s/1qXbk6HQ" target="_blank" rel="external">百度云盘</a></p>
<h2 id="u56DB_u3001_u8BE6_u7EC6_u7834_u89E3_u6B65_u9AA4"><a href="#u56DB_u3001_u8BE6_u7EC6_u7834_u89E3_u6B65_u9AA4" class="headerlink" title="四、详细破解步骤"></a>四、详细破解步骤</h2><p>前面破解方法简述中已对操作的主要内容和目的进行了介绍，下面来详细说一说具体怎么操作。</p>
<h3 id="1_u3001_u4F7F_u80FD_u5149_u732B_u7684telnet"><a href="#1_u3001_u4F7F_u80FD_u5149_u732B_u7684telnet" class="headerlink" title="1、使能光猫的telnet"></a>1、使能光猫的telnet</h3><p>首先将PC电脑的IP地址设置为光猫的同一网段，我修改为路由模式的HG8120C缺省网段为<code>192.168.1.0/24</code>。用网线将电脑连接到光猫的LAN1/LAN2口，保证电脑与光猫通信正常（可以用ping来测试到192.168.1.1的连通性），并拔掉光猫的光纤。</p>
<p>运行<code>华为ONT组播版本配置工具</code>，选择“维修使能”，并选择连接到光猫的网卡，接着点启动即可。<br><div class="figure " style="width:;"><img class="fig-img" src="ONT_enable_tool.png" width="" height="" alt=""></div><br>下面的“发送进度”进度条会开始有进度，这时候观察你的光猫指示灯（注意：一直保持光纤断开状态，切记不要连接光纤！），刚开始光信号灯会是红灯闪烁，等到光信号灯不亮，LAN1、LAN2、网络E/G三个灯长亮，这时即可按下工具的停止按钮，关闭工具。此时光猫将自动复位重启，之后就可以通过命令行的telnet工具登录了。虽然没有抓包分析，但是我猜测这个工具是通过组播广播特定的报文，让光猫进入维修状态（使能telnet）。而且，telnet服务只对内网IP访问有效，WAN侧无法连接，所以也无需担心使能telnet后，其他人来搞破坏。</p>
<h3 id="2_u3001_u5907_u4EFDhw_ctree-xml_u914D_u7F6E_u6587_u4EF6"><a href="#2_u3001_u5907_u4EFDhw_ctree-xml_u914D_u7F6E_u6587_u4EF6" class="headerlink" title="2、备份hw_ctree.xml配置文件"></a>2、备份hw_ctree.xml配置文件</h3><p>telnet<code>192.168.1.1</code>访问光猫，用root:admin缺省用户名、密码登录，这时便进入了华为WAP环境的普通用户模式。在电脑上运行<code>tftpd</code>启动TFTP服务，然后在telnet中使用<code>backup cfg</code>命令备份出自己光猫的配置文件 hw_ctree.xml。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">backup cfg by tftp svrip <span class="number">192.168</span>.<span class="number">1.2</span> remotefile hw_ctree.xml</span><br></pre></td></tr></table></figure></p>
<p>参数<code>svrip</code>后的IP地址为电脑本机地址，备份的hw_ctree.xml文件可以在tftpd软件的当前目录下找到。</p>
<p>BTW，如前所述这个telnet服务只对内网访问有效，我觉得没必要修改root密码，如果不放心，可以通过命令<code>set userpasswd root</code>来重新设置。</p>
<h3 id="3_u3001_u89E3_u5BC6hw_ctree-xml_u6587_u4EF6"><a href="#3_u3001_u89E3_u5BC6hw_ctree-xml_u6587_u4EF6" class="headerlink" title="3、解密hw_ctree.xml文件"></a>3、解密hw_ctree.xml文件</h3><p>备份<code>hw_ctree.xml</code>文件有两个目的：首先，在恢复到华为版固件模式后便于导入，不用再去配置LOID、VLAN等业务信息，这些信息在电信版固件模式下是通过新设备注册流程，网管系统远程自动下发的，自己配置太繁琐。其次，有了这个配置文件并解密后，可以查看自己的<code>telecomadmin</code>超级管理员帐号密码，这个密码也是网管系统在注册时随机生成的，一旦注册后就不再是缺省密码了。</p>
<p>其实这个叫<code>hw_ctree.xml</code>的文件并不是一个简单的xml文件！它是xml经过<code>gzip</code>压缩后再用<code>aescrypt2</code>算法加密生成的（华为做这事儿得多蛋疼啊😂😂😂）。如果想要对其进行解密，首先需要将文件名修改为<code>hw_ctree.xml.gz</code>，然后再运行<code>华为光猫配置文件加解密工具</code>做aescrypt2解密，这样便得到了一个解密后的gz文件。随便用一个支持gzip解压缩的工具软件，即可解压出xml明文配置文件。用文本编辑器打开后，搜索<code>telecomadmin</code>便可看见它的密码。</p>
<h3 id="4_u3001_u6062_u590D_u534E_u4E3A_u5B98_u65B9_u7248_u56FA_u4EF6_u6A21_u5F0F"><a href="#4_u3001_u6062_u590D_u534E_u4E3A_u5B98_u65B9_u7248_u56FA_u4EF6_u6A21_u5F0F" class="headerlink" title="4、恢复华为官方版固件模式"></a>4、恢复华为官方版固件模式</h3><p>继续在telnet输入<code>su</code>命令以进入WAP环境的超级用户模式，此时命令行将提示一个challenge code，运行<code>华为光猫SU密码计算器</code>输入这个challenge计算verification code，输入后即通过验证。<br><div class="figure " style="width:;"><img class="fig-img" src="su_verification.png" width="" height="" alt=""></div><br>进入超级用户模式后，只需要运行<code>restorehwmode.sh</code>脚本，便可恢复至华为官方版固件，解除电信固件的管理限制。</p>
<font color="red"> <em>注意：一旦运行该命令，将清空当前光猫的所有配置。重启复位后，虽然已运行华为官方固件，但光猫配置为出厂缺省状态。如果第2步的配置文件备份没有成功，将会非常麻烦！</em> </font>

<h3 id="5_u3001_u8FD8_u539F_u5149_u732B_u914D_u7F6E"><a href="#5_u3001_u8FD8_u539F_u5149_u732B_u914D_u7F6E" class="headerlink" title="5、还原光猫配置"></a>5、还原光猫配置</h3><p>恢复为华为版固件的光猫缺省配置，与电信版有些不同，需要再次修改电脑的IP地址为<code>192.168.100.0/24</code>网段，才能使用浏览器访问<code>192.168.100.1</code>光猫的Web管理后台。使用telecomadmin的缺省密码<code>nE7jA%5m</code>即可登录。<br><div class="figure " style="width:;"><img class="fig-img" src="HG8120C_huawei_Ver_Web.png" width="" height="" alt=""></div><br>然后选择“系统工具—配置文件”，上传第二步备份的配置文件，从而恢复所有业务配置。光猫在上传成功后将自动复位。</p>
<p>注意：这个配置文件是通过tftp备份出来的原始文件，即加密的配置文件。如果需要修改一些配置后再上传更新，应在修改完xml明文文件后，重新gz并加密。</p>
<h3 id="6_u3001_u6210_u529F_u7834_u89E3"><a href="#6_u3001_u6210_u529F_u7834_u89E3" class="headerlink" title="6、成功破解"></a>6、成功破解</h3><p>复位后的光猫，既恢复了之前的业务配置，又切换到了华为版固件，可以随意蹂躏！😄😄😄</p>
<p>只是，此处还需注意两点：首先，再次修改电脑的IP地址为<code>192.168.1.0/24</code>网段，因为此时的配置已恢复，光猫的地址也变回<code>192.168.1.1</code>。其次，telecomadmin帐号登录时的密码也已恢复，只能在第三步解密的配置文件中读取。<br><div class="figure " style="width:;"><img class="fig-img" src="HG8120C_huawei_Ver_feature.png" width="" height="" alt=""></div><br>上图为我整理的华为版光猫固件导航菜单，一眼即可发现多了很多功能，当然也包括我需要的——“终端个数限制”的修改！！</p>
<p>至此，全部破解完毕！</p>
<h1 id="u540E_u8BB0"><a href="#u540E_u8BB0" class="headerlink" title="后记"></a>后记</h1><p>弄好网络后，我在内网中接入了一台Raspberry Pi，并配置好基于PPTP的VPN服务；又在光猫上设置了VPN <code>端口映射</code>与3322.org的<code>DDNS</code>服务；以及个人域名到DDNS域名的CNAME解析。这样，便开通了直拨家庭网络的个人VPN，既方便自己出门在外时访问内网的Apple Timecapsule网络存储，又可以跟加州的同学对开VPN，他看国内视频、我访问被墙的各种资源。</p>
<p><font color="green"> <strong>如您认为此文对您有所帮助，请不要忘记留言让我知道！</strong> </font> ✌️</p>

            
                

            
        </div>
    </div>
    <div class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/HG8120C/">HG8120C</a> <a class="tag tag--primary tag--small t-link" href="/tags/Huawei/">Huawei</a>

            </div>
        
        <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2015/12/15/0004-How-to-install-the-dependencies-of-a-npm-package-into-it-s-own-npm-modules/"  data-tooltip="如何将npm包的依赖包安装在自己的npm_modules目录？">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2015/11/18/0002-sidebar-favorites-items-is-missing-in-osx-el-capitan/" data-tooltip="升级El Capitan后打开/存储文件时Finder的个人收藏位置消失？">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
      
        <li class="post-action ds-share hide-xs" data-thread-key="post-0003-Why-I-must-crack-ChinaNet-GPON-Modem" data-title="我为什么必须要破解电信光猫？" data-url="http://www.yeezhang.im/2015/12/10/0003-Why-I-must-crack-ChinaNet-GPON-Modem/"><a class="ds-wechat post-action-btn btn btn--default" href="javascript:void(0);" data-service="wechat" title="分享微信"><i class="fa fa-weixin"></i></a></li>


        
            <li class="post-action">
                <a class="post-action-btn btn btn--default" href="#ds-thread" title="评论">
                    <i class="fa fa-comment-o"></i>
                </a>
            </li>
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" title="文章目录">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            <!-- 多说评论框 start -->
<div class="ds-thread" data-thread-key="post-0003-Why-I-must-crack-ChinaNet-GPON-Modem" data-title="我为什么必须要破解电信光猫？" data-url="http://www.yeezhang.im/2015/12/10/0003-Why-I-must-crack-ChinaNet-GPON-Modem/"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {
    short_name: 'yeezhang'
};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';
    ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
<!-- 多说公共JS代码 end -->

        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2015 Yee Zhang. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="1">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2015/12/15/0004-How-to-install-the-dependencies-of-a-npm-package-into-it-s-own-npm-modules/"  data-tooltip="如何将npm包的依赖包安装在自己的npm_modules目录？">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2015/11/18/0002-sidebar-favorites-items-is-missing-in-osx-el-capitan/" data-tooltip="升级El Capitan后打开/存储文件时Finder的个人收藏位置消失？">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
      
        <li class="post-action ds-share hide-xs" data-thread-key="post-0003-Why-I-must-crack-ChinaNet-GPON-Modem" data-title="我为什么必须要破解电信光猫？" data-url="http://www.yeezhang.im/2015/12/10/0003-Why-I-must-crack-ChinaNet-GPON-Modem/"><a class="ds-wechat post-action-btn btn btn--default" href="javascript:void(0);" data-service="wechat" title="分享微信"><i class="fa fa-weixin"></i></a></li>


        
            <li class="post-action">
                <a class="post-action-btn btn btn--default" href="#ds-thread" title="评论">
                    <i class="fa fa-comment-o"></i>
                </a>
            </li>
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" title="文章目录">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="1">
    <ul class="share-options">
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=http://www.yeezhang.im/2015/12/10/0003-Why-I-must-crack-ChinaNet-GPON-Modem/">
                <i class="fa fa-google-plus"></i><span class="">Share on Google Plus</span>
            </a>
        </li>
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://www.yeezhang.im/2015/12/10/0003-Why-I-must-crack-ChinaNet-GPON-Modem/">
                <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
            </a>
        </li>
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=http://www.yeezhang.im/2015/12/10/0003-Why-I-must-crack-ChinaNet-GPON-Modem/">
                <i class="fa fa-twitter"></i><span>Share on Twitter</span>
            </a>
        </li>
    </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
            
        </div>
        <div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/gravatar.jpg"/>
        
            <h4 id="about-card-name">Yee Zhang</h4>
        
            <h5 id="about-card-bio"><p>80前工程师，涉猎广而不精</p>
</h5>
        
        
            <h5 id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>现任职于：超声医疗国家工程研究中心</p>

            </h5>
        
        
            <h5 id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                Chongqing, China
            </h5>
        
    </div>
</div>

        <div id="cover" style="background-image:url('/assets/images/cover-img.jpg');"></div>
    </body>
    <!--SCRIPTS-->
<script src="/assets/js/script.min.js" type="text/javascript"></script>
<!--SCRIPTS END-->



</html>
